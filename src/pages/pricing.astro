---
import Layout from "../layouts/Layout.astro";
import { parse } from "cookie";

// ูุฑุงุกุฉ ุงููููู ููุนุฑูุฉ ูู ุงููุณุชุฎุฏู ูุณุฌู ุงูุฏุฎูู
const cookies = parse(Astro.request.headers.get("cookie") || "");
const token = cookies["user_token"];
const isLogged = Boolean(token);

// ุชุนุฑูู ุฎุทุท ุงูุงุดุชุฑุงู (ูุชูุงููุฉ ูุน PayPal)
const plans = [
  {
    id: "basic",
    name: "Basic",
    price: 29,
    usd: 3,
    credits: 60,
  },
  {
    id: "pro",
    name: "Pro",
    price: 49,
    usd: 5,
    credits: 180,
  },
  {
    id: "enterprise",
    name: "Enterprise",
    price: 99,
    usd: 10,
    credits: 600,
  }
];

// ุชูููุฏ ุฑุงุจุท PayPal API
function paypalUrl(planId) {
  return `/api/paypal/create-subscription?plan=${planId}`;
}
---

<Layout title="ุงูุฃุณุนุงุฑ">
  <section class="min-h-screen bg-gray-50 py-12">
    <div class="max-w-5xl mx-auto px-4">

      <h1 class="text-center text-3xl font-bold text-gray-900 mb-4">
        ุงุฎุชุฑ ุงูุฎุทุฉ ุงูููุงุณุจุฉ ูุงุจุฏุฃ ุชุญููู ุงูุตูุช ูุงูููุฏูู ุจุฏูุฉ ุนุงููุฉ
      </h1>

      <p class="text-center text-gray-600 mb-10">
        ุงูุฃุณุนุงุฑ ุชูุญุชุณุจ ุจุงูุฏููุงุฑ ุนุจุฑ PayPalุ ูุงูุฃุฑูุงู ุจุงูุฏุฑูู ุชูุฑูุจูุฉ ููุท ูุฑุงุญุฉ ุงูุฒุจูุงุก ูู ุงููุบุฑุจ.
      </p>

      <div class="grid gap-6 md:grid-cols-3 mb-16">

        <!-- BASIC PLAN -->
        <div class="bg-white rounded-2xl shadow p-6 border border-gray-100">
          <h2 class="text-xl font-bold text-gray-900 mb-1">Basic</h2>
          <p class="text-sm text-gray-500 mb-4">ููุงุณุชุนูุงู ุงูุดุฎุตู</p>
          <p class="text-3xl font-bold text-purple-600 mb-1">$3</p>
          <p class="text-xs text-gray-500 mb-4">โ 29 ุฏุฑูู / ุดูุฑูุงู</p>

          <ul class="space-y-2 text-sm text-gray-700 mb-6">
            <li>โ 60 Credit ุดูุฑูุงู</li>
            <li>โ 20 ุชูุฎูุต ุดูุฑูุงู</li>
            <li>โ 20 ุฅูุดุงุก ููุงู ุดูุฑูุงู</li>
            <li>โ ุฏุนู ุนุงุฏู</li>
          </ul>

          {isLogged ? (
            <a href={paypalUrl("basic")}
               class="w-full rounded-xl bg-purple-600 text-white py-2.5 text-sm font-semibold block text-center">
               ๐ณ ุงุฏูุน ุงูุขู ุนุจุฑ PayPal
            </a>
          ) : (
            <a href="/login?redirect=/pricing"
               class="w-full rounded-xl bg-purple-600 text-white py-2.5 text-sm font-semibold block text-center">
               ๐ ุณุฌูู ุงูุฏุฎูู ููุงุดุชุฑุงู
            </a>
          )}
        </div>

        <!-- PRO PLAN -->
        <div class="bg-white rounded-2xl shadow-lg p-6 border-2 border-purple-500 relative">
          <span class="absolute -top-3 left-4 bg-purple-600 text-white text-xs font-semibold px-3 py-1 rounded-full">
            ุงูุฃูุซุฑ ุงุณุชุนูุงูุงู
          </span>
          <h2 class="text-xl font-bold text-gray-900 mb-1">Pro</h2>
          <p class="text-sm text-gray-500 mb-4">ูุตูุงุน ุงููุญุชูู ูุงูุทูุงุจ</p>
          <p class="text-3xl font-bold text-purple-600 mb-1">$5</p>
          <p class="text-xs text-gray-500 mb-4">โ 49 ุฏุฑูู / ุดูุฑูุงู</p>

          <ul class="space-y-2 text-sm text-gray-700 mb-6">
            <li>โ 180 Credit ุดูุฑูุงู</li>
            <li>โ ููุงุณุจ ููุจูุฏูุงุณุช ูุงูุฏูุฑุงุช ูุงูููุชููุจ</li>
            <li>โ 50 ุชูุฎูุต ุดูุฑูุงู</li>
            <li>โ 50 ุฅูุดุงุก ููุงู ุดูุฑูุงู</li>
            <li>โ ุฏุนู ุนุจุฑ ูุงุชุณุงุจ</li>
          </ul>

          {isLogged ? (
            <a href={paypalUrl("pro")}
               class="w-full rounded-xl bg-purple-600 text-white py-2.5 text-sm font-semibold block text-center">
               ๐ณ ุงุดุชุฑู ุงูุขู ุนุจุฑ PayPal
            </a>
          ) : (
            <a href="/login?redirect=/pricing"
               class="w-full rounded-xl bg-purple-600 text-white py-2.5 text-sm font-semibold block text-center">
               ๐ ุณุฌูู ุงูุฏุฎูู ููุงุดุชุฑุงู
            </a>
          )}
        </div>

        <!-- ENTERPRISE PLAN -->
        <div class="bg-white rounded-2xl shadow p-6 border border-gray-100">
          <h2 class="text-xl font-bold text-gray-900 mb-1">Enterprise</h2>
          <p class="text-sm text-gray-500 mb-4">ููุดุฑูุงุช ูุงููุคุณุณุงุช</p>
          <p class="text-3xl font-bold text-purple-600 mb-1">$10</p>
          <p class="text-xs text-gray-500 mb-4">โ 99 ุฏุฑูู / ุดูุฑูุงู</p>

          <ul class="space-y-2 text-sm text-gray-700 mb-6">
            <li>โ 600 Credit ุดูุฑูุงู</li>
            <li>โ 150 ุชูุฎูุต</li>
            <li>โ 150 ููุงู</li>
            <li>โ ุฏุนู ุณุฑูุน + ุฃููููุฉ</li>
          </ul>

          {isLogged ? (
            <a href={paypalUrl("enterprise")}
               class="w-full rounded-xl bg-purple-600 text-white py-2.5 text-sm font-semibold block text-center">
               ๐ณ ุงุดุชุฑู ุงูุขู ุนุจุฑ PayPal
            </a>
          ) : (
            <a href="/login?redirect=/pricing"
               class="w-full rounded-xl bg-purple-600 text-white py-2.5 text-sm font-semibold block text-center">
               ๐ ุณุฌูู ุงูุฏุฎูู ููุงุดุชุฑุงู
            </a>
          )}
        </div>
      </div>

      <p class="text-center text-xs text-gray-500 mt-6">
        ุจุนุฏ ูุฌุงุญ ุงูุฃุฏุงุกุ ูุชู ุชูุนูู Credits ุชููุงุฆูุงู ูุฑุจุทูุง ุจุญุณุงุจู ุนูู Transcribe.ma
      </p>

    </div>
  </section>
</Layout>

---
import fs from "fs";
import path from "path";

// Load users
const filePath = path.join(process.cwd(), "src/data/users.json");
const users = JSON.parse(fs.readFileSync(filePath, "utf8"));
---

<html lang="ar" dir="rtl">
    <meta charset="UTF-8" />
<body style="font-family: sans-serif; padding: 20px;">

<h1>لوحة تحكم الأدمين</h1>

<table border="1" cellspacing="0" cellpadding="10" width="100%">
  <tr>
    <th>ID</th>
    <th>الاسم</th>
    <th>البريد</th>
    <th>الرصيد</th>
    <th>تحكم</th>
  </tr>

  {users.map(u => (
    <tr>
      <td>{u.id}</td>
      <td>{u.name}</td>
      <td>{u.email}</td>
      <td>{u.minutes || 0} دقيقة</td>
      <td>
        <form method="POST" action="/api/add-minutes" style="display:flex; gap:10px;">
  <input type="hidden" name="userId" value={u.id} />

  <select name="type" required>
    <option value="minutes">دقائق</option>
    <option value="summaries">تلخيصات</option>
    <option value="articles">مقالات</option>
  </select>

  <input type="number" name="value" placeholder="الكمية" required />

  <button type="submit">إضافة</button>
</form>

      </td>
    </tr>
  ))}
</table>

<br />
<a href="/logout-admin" style="color:red;">تسجيل الخروج</a>

</body>
</html>
